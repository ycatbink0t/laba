webpackJsonp([1],{"/+Wt":function(e,t){},"3j4+":function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7+uW"),a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("nav",[n("router-link",{attrs:{to:"/tables"}},[e._v("Edit database Tables")]),e._v(" "),n("router-link",{attrs:{to:"/adduser"}},[e._v("Add user")]),e._v(" "),n("router-link",{attrs:{to:"/addstreet"}},[e._v("Add street")]),e._v(" "),n("router-link",{attrs:{to:"/addroute"}},[e._v("Add route")]),e._v(" "),n("router-link",{attrs:{to:"/personroutes"}},[e._v("Persons routes")])],1),e._v(" "),n("router-view")],1)},staticRenderFns:[]};var s=n("VU/8")({name:"App"},a,!1,function(e){n("yeoK")},null,null).exports,i=n("/ocq"),o=n("mvHQ"),u=n.n(o),d=n("mtWM"),l=n.n(d),c=n("M4fF"),m={name:"App",data:function(){return{currentValue:"",links:[{name:"loading"}],search:"",message:"DMS v0.3",tables:[{name:"Choose table",newRows:[]}]}},methods:{dataEdited:function(e){var t=this.tables.find(function(t){return t.name===e.name}),n={what:"update",name:e.name,id:e.id,header:t.headers[e.headerIndex],value:e.newValue};l.a.post("/dms/api/",u()(n)).then(function(n){if(220===n.status)return 0;t.rows.find(function(t){return t.id===e.id}).cells[e.headerIndex]=e.newValue})},tableChanged:function(e){var t=this;l.a.get("/dms/api"+e).then(function(e){var n=e.data;n.hasOwnProperty("rows")||(n.rows=[]),n.newRows=[],t.tables=[n]})},addNewRow:function(e){for(var t=this.tables.find(function(t){return t.name===e.name}),n=[],r=0;r<t.headers.length;r++)n.push("Fill this cell");t.newRows.push(n)},newDataEdited:function(e){this.tables.find(function(t){return t.name===e.name}).newRows[e.rowIndex][e.headerIndex]=e.newValue},saveNewRow:function(e){var t=this.tables.find(function(t){return t.name===e.name}),n={what:"insert",name:e.name,headers:t.headers,values:t.newRows[e.rowIndex]};l.a.post("/dms/api/",u()(n)).then(function(n){if(221===n.status)return alert(n.data),0;var r=n.data,a=t.newRows.splice(e.rowIndex,1)[0];t.rows.push({id:r,cells:a})})},deleteRow:function(e){if(!confirm())return 0;var t=this.tables.find(function(t){return t.name===e.name});l.a.post("/dms/api/",u()({what:"delete",id:e.id,name:e.name})).then(function(n){t.rows.splice(e.rowIndex,1)})},deleteNewRow:function(e){if(!confirm())return 0;this.tables.find(function(t){return t.name===e.name}).newRows.splice(e.rowIndex,1)},searchUpdate:function(e){var t=this;console.log(this.search),l.a.get("/dms/api?what=search&value="+this.search).then(function(e){console.log(e.data);var n=e.data;n.forEach(function(e){e.newRows=[]}),t.tables=n})},searchEdited:function(e){console.log("search watcher"),this.search=event.target.value,this.tables=[{name:"Loading...",newRows:[]}],this.debouncedGetAnswer()}},created:function(){var e=this;l.a.get("/dms/api?what=links").then(function(t){e.links=t.data}),this.debouncedGetAnswer=Object(c.debounce)(this.searchUpdate,1e3)}},v={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"tables"}},[n("input",{attrs:{id:"search",placeholder:"Search"},on:{input:e.searchEdited}}),e._v(" "),n("div",{staticClass:"tables-links"},[n("ul",e._l(e.links,function(t){return n("li",{key:t.name,attrs:{name:t.name},on:{click:function(n){return e.tableChanged("?what=table&name="+t.name)}}},[n("a",[e._v(e._s(t.name))])])}),0)]),e._v(" "),n("div",{staticClass:"tables"},e._l(e.tables,function(t){return n("div",{key:t},[n("h2",[e._v(e._s(t.name))]),e._v(" "),n("table",[n("tbody",[n("tr",[n("th"),e._v(" "),e._l(t.headers,function(t){return n("th",{key:t},[e._v(e._s(t))])})],2),e._v(" "),e._l(t.rows,function(r,a){return n("tr",{key:a},[n("button",{on:{click:function(n){return e.deleteRow({name:t.name,id:r.id,rowIndex:a})}}},[e._v("Delete")]),e._v(" "),e._l(r.cells,function(a,s){return n("td",{key:s},[n("input",{attrs:{type:"text"},domProps:{value:a},on:{change:function(n){return e.dataEdited({newValue:a,id:r.id,headerIndex:s,name:t.name})}}})])})],2)}),e._v(" "),t.newRows.length>0?e._l(t.newRows,function(r,a){return n("tr",{key:a},[n("button",{on:{click:function(n){return e.deleteNewRow({name:t.name,rowIndex:a})}}},[e._v("Delete")]),e._v(" "),e._l(r,function(r,s){return n("td",{key:r},[n("input",{attrs:{type:"text"},domProps:{value:r},on:{change:function(n){return e.newDataEdited({newValue:n.target.value,headerIndex:s,rowIndex:a,name:t.name})}}})])}),e._v(" "),n("button",{on:{click:function(n){return e.saveNewRow({rowIndex:a,name:t.name})}}},[e._v("Save")])],2)}):e._e(),e._v(" "),n("button",{on:{click:function(n){return e.addNewRow({name:t.name})}}},[e._v("Add new row")])],2)])])}),0)])},staticRenderFns:[]};var p=n("VU/8")(m,v,!1,function(e){n("d/td")},null,null).exports,_={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"form"},[t("form",{attrs:{action:"/dms/adduserform/",method:"post"}},[t("label",[this._v("First name:\n      "),t("input",{attrs:{type:"text",name:"first_name"}})]),this._v(" "),t("label",[this._v("Last name:\n      "),t("input",{attrs:{type:"text",name:"last_name"}})]),this._v(" "),t("label",[this._v("Date of birth:\n      "),t("input",{attrs:{type:"date",name:"date_of_birth"}})]),this._v(" "),t("input",{attrs:{type:"submit",value:"Submit"}})])])}]};var f=n("VU/8")({name:"adduser"},_,!1,function(e){n("TWYt")},"data-v-1e494596",null).exports,h={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"form"},[t("form",{attrs:{action:"/dms/addstreetform/",method:"post"}},[t("label",[this._v("Street name:\n      "),t("input",{attrs:{type:"text",name:"street_name"}})]),this._v(" "),t("input",{attrs:{type:"submit",value:"Submit"}})])])}]};var w=n("VU/8")({name:"AddStreet"},h,!1,function(e){n("owpD")},"data-v-5104e422",null).exports,b={name:"AddRoute",data:function(){return{request:{what:"addroute",personId:-1,streets:[],time_departure:"",time_arrive:"",type:""},selectedPerson:"",selectedStreet:"",selectedStreets:[],streets:[{id:-1,street_name:"Loading..."}],persons:[{id:-1,first_name:"Loa",last_name:"ding..."}]}},created:function(){var e=this;l.a.get("/dms/api?what=streets").then(function(t){e.streets=t.data}),l.a.get("/dms/api?what=persons").then(function(t){e.persons=t.data})},methods:{submit:function(){var e=this;l.a.post("/dms/api/",u()(this.request)).then(function(){e.$router.go(-1),alert("Route added")})},pushStreet:function(){var e=this;this.request.streets.find(function(t){return t===e.selectedStreetId})||(this.selectedStreets.push(this.selectedStreet),this.request.streets.push(this.selectedStreetId))}},computed:{selectedStreetId:function(){var e=this;return this.streets.find(function(t){return t.street_name===e.selectedStreet}).id}},watch:{selectedPerson:function(){var e=this;this.request.personId=this.persons.find(function(t){return t.first_name+" "+t.last_name===e.selectedPerson}).id}}},g={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form"},[n("label",{attrs:{title:"Bus, car, bike etc"}},[e._v("Type:\n    "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.request.type,expression:"request.type"}],attrs:{type:"text"},domProps:{value:e.request.type},on:{input:function(t){t.target.composing||e.$set(e.request,"type",t.target.value)}}})]),e._v(" "),n("label",[e._v("Time departure:\n    "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.request.time_departure,expression:"request.time_departure"}],attrs:{type:"time"},domProps:{value:e.request.time_departure},on:{input:function(t){t.target.composing||e.$set(e.request,"time_departure",t.target.value)}}})]),e._v(" "),n("label",[e._v("Time arrive:\n    "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.request.time_arrive,expression:"request.time_arrive"}],attrs:{type:"time"},domProps:{value:e.request.time_arrive},on:{input:function(t){t.target.composing||e.$set(e.request,"time_arrive",t.target.value)}}})]),e._v(" "),n("label",[e._v("Select owner:\n    "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedPerson,expression:"selectedPerson"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selectedPerson=t.target.multiple?n:n[0]}}},e._l(e.persons,function(t){return n("option",{key:t.id},[e._v(e._s(t.first_name+" "+t.last_name))])}),0)]),e._v(" "),n("label",{attrs:{title:"Select street to add to route"}},[e._v("Select street:\n  "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedStreet,expression:"selectedStreet"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selectedStreet=t.target.multiple?n:n[0]}}},e._l(e.streets,function(t){return n("option",{key:t.id},[e._v(e._s(t.street_name))])}),0)]),e._v(" "),n("input",{attrs:{type:"button",value:"Add street to route"},on:{click:e.pushStreet}}),e._v(" "),n("br"),e._v(" "),n("p",[e._v("\n    Streets : "+e._s(e.selectedStreets.reduce(function(e,t){return e+", "+t},"").slice(2))+"\n  ")]),e._v(" "),n("br"),e._v(" "),n("input",{attrs:{type:"button",value:"submit"},on:{click:e.submit}})])},staticRenderFns:[]};var y=n("VU/8")(b,g,!1,function(e){n("/+Wt")},"data-v-3c8d35b0",null).exports,x={name:"PersonsRoutesView",data:function(){return{persons:[{first_name:"Loading...",last_name:" ",routes:[{}]}]}},created:function(){var e=this;l.a.get("/dms/api?what=person_routes").then(function(t){console.log(t.data),e.persons=t.data})}},k={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},e._l(e.persons,function(t){return n("div",{key:t},[t.routes.length>0?[n("h2",[e._v("\n        "+e._s(t.first_name+" "+t.last_name)+"\n      ")]),e._v(" "),n("div",{staticClass:"persona"},e._l(t.routes,function(t){return n("div",{key:t,staticClass:"route"},[e._v("\n          Time departure: "+e._s(t.time_departure)+"\n          "),n("br"),e._v("\n          Time arrive: "+e._s(t.time_arrive)+"\n          "),n("br"),e._v("\n          Transport type: "+e._s(t.type)+"\n          "),n("br"),e._v("\n          Streets: "+e._s(t.streets.join(", "))+"\n        ")])}),0)]:e._e()],2)}),0)},staticRenderFns:[]};var R=n("VU/8")(x,k,!1,function(e){n("3j4+")},"data-v-9a8a2716",null).exports;r.a.use(i.a);var S=new i.a({routes:[{path:"/"},{path:"/tables",name:"tables",component:p},{path:"/adduser",name:"adduser",component:f},{path:"/addstreet",name:"addstreet",component:w},{path:"/addroute",name:"addroute",component:y},{path:"/personroutes",name:"personroutes",component:R}]});r.a.config.productionTip=!1,new r.a({el:"#app",router:S,components:{App:s},template:"<App/>"})},TWYt:function(e,t){},"d/td":function(e,t){},owpD:function(e,t){},yeoK:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.a91c569647892b0efed3.js.map